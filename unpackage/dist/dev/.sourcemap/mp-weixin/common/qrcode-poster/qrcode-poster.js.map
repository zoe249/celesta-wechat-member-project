{"version":3,"sources":["webpack:///G:/代码-项目/悦朋/uniapp/O2O/悦朋微会员/celesta-wechat-member-project/common/qrcode-poster/qrcode-poster.vue?fdcb","webpack:///G:/代码-项目/悦朋/uniapp/O2O/悦朋微会员/celesta-wechat-member-project/common/qrcode-poster/qrcode-poster.vue?40da","webpack:///G:/代码-项目/悦朋/uniapp/O2O/悦朋微会员/celesta-wechat-member-project/common/qrcode-poster/qrcode-poster.vue?5f01","webpack:///G:/代码-项目/悦朋/uniapp/O2O/悦朋微会员/celesta-wechat-member-project/common/qrcode-poster/qrcode-poster.vue?72ec","uni-app:///common/qrcode-poster/qrcode-poster.vue","webpack:///G:/代码-项目/悦朋/uniapp/O2O/悦朋微会员/celesta-wechat-member-project/common/qrcode-poster/qrcode-poster.vue?3ae9","webpack:///G:/代码-项目/悦朋/uniapp/O2O/悦朋微会员/celesta-wechat-member-project/common/qrcode-poster/qrcode-poster.vue?49f7"],"names":["props","goodsInfo","headerImg","data","canvasW","canvasH","ctx","isShow","qrcode","methods","showCanvas","__init","uni","title","mask","bennerImg","priceBg","hW","hH","point","price","marketPrice","priceLength","pointLength","length","surplus","goodsName","limit","qrcodeImg","setTimeout","drawText","lineWidth","initHeight","lastSubStrIndex","titleHeight","storeBgColor","drawEmptyRound","drawDashLine","xpos","ypos","numDashes","drawSolidLine","drawRoundImg","drawRoundRect","getImageInfo","src","success","resolve","fail","reject","console","saveImage","canvasId","quality","complete","filePath","icon","duration","that"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsI;AACtI;AACiE;AACL;AACsC;;;AAGlG;AAC0K;AAC1K,gBAAgB,mLAAU;AAC1B,EAAE,mFAAM;AACR,EAAE,oGAAM;AACR,EAAE,6GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,wGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACdA;AAAA;AAAA;AAAA;AAAgoB,CAAgB,qpBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;eCQppB;EACAA;IACAC;IAAA;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAC;kBACAC;kBACAC;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;;gBAEA;gBAAA;gBAAA,OACA;cAAA;gBAAAC;gBACA;;gBAEA;gBAAA;gBAAA,OACA;cAAA;gBAAAC;gBACA;gBAEAC;gBACAC;gBAEAC;gBACAC;gBAEA;kBACA;kBACA;kBACA;kBACA;kBACA;kBACA;;kBAEA;kBACAC;kBACAC;kBACA;kBACA;kBACA;;kBAEA;kBACA;gBACA;kBACA;kBACA;kBACA;kBACA;kBACA;;kBAEA;kBACAC;kBACAF;kBACA;kBACA;kBACA;;kBAEA;kBACA;gBAEA;kBAEA;kBACA;kBACA;kBACA;;kBAEA;kBACA;kBACA;kBACAD;kBACA;kBACA;kBACA;;kBAEA;kBACAC;kBACAC;kBACAC;kBACAC;kBACA;kBACA;kBACA;;kBAEA;kBACA;gBACA;;gBAEA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;;gBAEA;gBACA;gBACA;gBACA;gBACA;gBACA;;gBAEA;gBACA;;gBAEA;gBACA;gBACA;gBACA;gBACA;;gBAEA;gBACAC,uDACA;gBACA;gBACA;gBACA;;gBAGA;gBACAC;gBACA;kBACAA;gBACA;gBACA;gBACA;gBACA;;gBAEA;gBACAC;gBACA;gBACA;gBACA;gBACA;;gBAEA;gBACA;;gBAEA;gBACA;;gBAEA;gBACA;;gBAEA;gBACA;gBACA;gBACA;;gBAEA;gBACA;gBACA;gBACA;;gBAEA;gBAAA;gBAAA,OACA;cAAA;gBAAAC;gBACA;gBACA;gBACAC;kBACA;oBACAjB;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAkB;MACA;MACA;MACA;QACAC;QACA;UACAzB;UACA0B;UACAD;UACAE;UACAC;QACA;QACA;UAAA;UACA5B;QACA;MACA;MACA;MACA4B;MACA;IACA;IACA;IACAC;MACA7B;MACAA;MACAA;MACAA;IACA;IACA;IACA8B;MACA9B;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;IACA;IACA;IACA+B;MACA/B;MACAA;MACA;QACAgC;QAAA;QACAC;QAAA;QACAC;MACA;MACA;QACA;UACAlC;UACA;QACA;UACAA;QACA;MACA;MACAA;IACA;IACA;IACAmC;MACAnC;MACAA;MACAA;MACAA;MACAA;IACA;IACA;IACAoC;MACApC;MACAA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACAA;MACAA;MACAA;IACA;IACA;IACAqC;MACArC;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;IACA;IACA;IACAsC;MAAA;MACA;QACAhC;UACAiC;UACAC;YACAC;UACA;UACAC;YACAC;YACAC;YACAtC;YACA;UACA;QACA;MACA;IACA;IACA;IACAuC;MACA;MACAvC;QACAkC;UACA;YACA;YACA;cACA;cACAlC;gBACAkC;kBACAI;gBACA;cACA;YACA;cACA;gBACA;gBACAtC;kBACAkC;oBACAI;kBACA;gBACA;cACA;YACA;UACA;YACA;UACA;QACA;MACA;MACA;MACAtC;QACAwC;QACAC;QACAC;UACA1C;YACA2C;YACAT;cACAlC;gBACAC;gBACA2C;gBACAC;cACA;cACA5B;gBACA6B;cACA;YACA;UACA;QACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC3WA;AAAA;AAAA;AAAA;AAAutC,CAAgB,orCAAG,EAAC,C;;;;;;;;;;;ACA3uC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"common/qrcode-poster/qrcode-poster.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./qrcode-poster.vue?vue&type=template&id=05250973&scoped=true&\"\nvar renderjs\nimport script from \"./qrcode-poster.vue?vue&type=script&lang=js&\"\nexport * from \"./qrcode-poster.vue?vue&type=script&lang=js&\"\nimport style0 from \"./qrcode-poster.vue?vue&type=style&index=0&id=05250973&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"05250973\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"common/qrcode-poster/qrcode-poster.vue\"\nexport default component.exports","export * from \"-!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./qrcode-poster.vue?vue&type=template&id=05250973&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      $event.stopPropagation()\n      _vm.isShow = false\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./qrcode-poster.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./qrcode-poster.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"content\" v-if=\"isShow\" @click.stop=\"isShow=false\">\r\n\t\t<canvas @click.stop=\"\" :style=\"{ width: canvasW + 'px', height: canvasH + 'px' }\" canvas-id=\"my-canvas\"></canvas>\r\n\t\t<view class=\"save-btn\" @click.stop=\"saveImage\">保存图片</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tprops: {\r\n\t\t\tgoodsInfo: Object, // 商品信息\r\n\t\t\theaderImg: String, // 商品主图\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tcanvasW: 0,\r\n\t\t\t\tcanvasH: 0,\r\n\t\t\t\tctx: null,\r\n\t\t\t\tisShow: false,\r\n\t\t\t\tqrcode: '',\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t//显示\r\n\t\t\tshowCanvas(qrcode) {\r\n\t\t\t\tthis.isShow = true\r\n\t\t\t\tthis.qrcode = qrcode\r\n\t\t\t\t// 绘制画布\r\n\t\t\t\tthis.__init() \r\n\t\t\t},\r\n\t\t\t// 商品初始化画布\r\n\t\t\tasync __init() {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '海报生成中',\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t})\r\n\t\t\t\tthis.ctx = uni.createCanvasContext('my-canvas', this)\r\n\t\t\t\tthis.canvasW = uni.upx2px(540);\r\n\t\t\t\tthis.canvasH = uni.upx2px(850);\r\n\t\t\t\t//设置画布背景透明\r\n\t\t\t\tthis.ctx.setFillStyle('rgba(255, 255, 255, 0)')\r\n\t\t\t\t//设置画布大小\r\n\t\t\t\tthis.ctx.fillRect(0, 0, this.canvasW, this.canvasH)\r\n\t\t\t\t//绘制圆角背景\r\n\t\t\t\tthis.drawRoundRect(this.ctx, 0, 0, this.canvasW, this.canvasH, uni.upx2px(18), '#FFFFFF')\r\n\t\t\t\t\r\n\t\t\t\t// goods benner\r\n\t\t\t\tlet bennerImg = await this.getImageInfo(this.headerImg)\r\n\t\t\t\tthis.drawRoundImg(this.ctx, bennerImg.path, 0, 0, uni.upx2px(540), uni.upx2px(400), uni.upx2px(0))\r\n\t\t\t\t\r\n\t\t\t\t// 售价背景\r\n\t\t\t\tlet priceBg = await this.getImageInfo(this.config.imgUrl + '/priceBg.png')\r\n\t\t\t\tthis.drawRoundImg(this.ctx, priceBg.path, 0, uni.upx2px(400), uni.upx2px(540), uni.upx2px(70), uni.upx2px(0))\r\n\t\t\t\t\r\n\t\t\t\tlet hW = uni.upx2px(500);\r\n\t\t\t\tlet hH = uni.upx2px(420);\r\n\t\t\t\t\r\n\t\t\t\tlet point = this.goodsInfo.usePoint.toString()\r\n\t\t\t\tlet price = this.goodsInfo.salePrice\r\n\t\t\t\t\r\n\t\t\t\tif(this.goodsType(this.goodsInfo) === 1){\r\n\t\t\t\t\t// 绘制售价\r\n\t\t\t\t\tthis.ctx.setFontSize(14);\r\n\t\t\t\t\tthis.ctx.setFillStyle('#FFFFFF');\r\n\t\t\t\t\tthis.ctx.fillText('￥', (uni.upx2px(20)), (uni.upx2px(450)))\r\n\t\t\t\t\tthis.ctx.setFontSize(25);\r\n\t\t\t\t\tthis.ctx.fillText(price, (uni.upx2px(45)), (uni.upx2px(450)))\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 参考价\r\n\t\t\t\t\tlet marketPrice = '￥' + this.goodsInfo.marketPrice\r\n\t\t\t\t\tlet priceLength = JSON.stringify(price).length\r\n\t\t\t\t\tthis.ctx.setFontSize(14);\r\n\t\t\t\t\tthis.ctx.setFillStyle('#DDDDDD');\r\n\t\t\t\t\tthis.ctx.fillText(marketPrice, (uni.upx2px(45) + (priceLength * 16)), (uni.upx2px(450)))\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 参考价划线\r\n\t\t\t\t\tthis.drawSolidLine(this.ctx, (uni.upx2px(45) + (priceLength * 16) - 1), uni.upx2px(442), (uni.upx2px(45) + (priceLength * 16) + (marketPrice.length * 11)), uni.upx2px(442))\r\n\t\t\t\t}else if(this.goodsType(this.goodsInfo) === 2){\r\n\t\t\t\t\t// 绘制积分\r\n\t\t\t\t\tthis.ctx.setFillStyle('#FFFFFF');\r\n\t\t\t\t\tthis.ctx.setFontSize(25);\r\n\t\t\t\t\tthis.ctx.fillText(point, (uni.upx2px(20)), (uni.upx2px(450)))\r\n\t\t\t\t\tthis.ctx.fillText('积分',((point.length * 16) + (uni.upx2px(25))), (uni.upx2px(450)))\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 参考价\r\n\t\t\t\t\tlet pointLength = JSON.stringify(point).length\r\n\t\t\t\t\tlet marketPrice = '￥' + this.goodsInfo.marketPrice\r\n\t\t\t\t\tthis.ctx.setFontSize(14);\r\n\t\t\t\t\tthis.ctx.setFillStyle('#DDDDDD');\r\n\t\t\t\t\tthis.ctx.fillText(marketPrice, (uni.upx2px(75) + (pointLength * 16)), (uni.upx2px(450)))\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 参考价划线\r\n\t\t\t\t\tthis.drawSolidLine(this.ctx, (uni.upx2px(75) + (pointLength * 16) - 1), uni.upx2px(442), (uni.upx2px(75) + (pointLength * 16) + (marketPrice.length * 16)), uni.upx2px(442))\r\n\t\t\t\t\t\r\n\t\t\t\t}else if(this.goodsType(this.goodsInfo === 3)){\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.ctx.setFillStyle('#FFFFFF')\r\n\t\t\t\t\tthis.ctx.setFontSize(16);\r\n\t\t\t\t\tthis.ctx.fillText(point, (uni.upx2px(20)), (uni.upx2px(450)))\r\n\t\t\t\t\tthis.ctx.fillText('积分',((point.length * 9) + (uni.upx2px(20))), (uni.upx2px(450)))\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 绘制售价\r\n\t\t\t\t\tthis.ctx.setFontSize(14);\r\n\t\t\t\t\t// this.ctx.fillText('￥', (uni.upx2px(20)), (uni.upx2px(450)))\r\n\t\t\t\t\tprice = '￥' + price\r\n\t\t\t\t\tthis.ctx.setFillStyle('#FFFFFF');\r\n\t\t\t\t\tthis.ctx.setFontSize(16);\r\n\t\t\t\t\tthis.ctx.fillText(price, (uni.upx2px(90) + (point.length * 9)), (uni.upx2px(450)))\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 参考价\r\n\t\t\t\t\tlet marketPrice = '￥' + this.goodsInfo.marketPrice\r\n\t\t\t\t\tlet priceLength = JSON.stringify(price).length\r\n\t\t\t\t\tlet pointLength = JSON.stringify(point).length\r\n\t\t\t\t\tlet length = priceLength + pointLength\r\n\t\t\t\t\tthis.ctx.setFontSize(13);\r\n\t\t\t\t\tthis.ctx.setFillStyle('#DDDDDD');\r\n\t\t\t\t\tthis.ctx.fillText(marketPrice, (uni.upx2px(20) + (length * 9.5)), (uni.upx2px(450)))\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 参考价划线\r\n\t\t\t\t\tthis.drawSolidLine(this.ctx, (uni.upx2px(20) + (length * 9.5) - 1), uni.upx2px(442), (uni.upx2px(20) + (length * 9.5) + (marketPrice.length * 9.5)), uni.upx2px(442))\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// // 绘制售价\r\n\t\t\t\t// let price = this.goodsInfo.salePrice\r\n\t\t\t\t// this.ctx.setFontSize(14);\r\n\t\t\t\t// this.ctx.setFillStyle('#FFFFFF');\r\n\t\t\t\t// this.ctx.fillText('￥', (uni.upx2px(20)), (uni.upx2px(450)))\r\n\t\t\t\t// this.ctx.setFontSize(25);\r\n\t\t\t\t// this.ctx.fillText(price, (uni.upx2px(45)), (uni.upx2px(450)))\r\n\t\t\t\t\r\n\t\t\t\t// // 参考价\r\n\t\t\t\t// let marketPrice = '￥' + this.goodsInfo.marketPrice\r\n\t\t\t\t// let priceLength = JSON.stringify(price).length\r\n\t\t\t\t// this.ctx.setFontSize(14);\r\n\t\t\t\t// this.ctx.setFillStyle('#DDDDDD');\r\n\t\t\t\t// this.ctx.fillText(marketPrice, (uni.upx2px(45) + (priceLength * 16)), (uni.upx2px(450)))\r\n\t\t\t\t\r\n\t\t\t\t// // 参考价划线\r\n\t\t\t\t// this.drawSolidLine(this.ctx, (uni.upx2px(45) + (priceLength * 16) - 1), uni.upx2px(442), (uni.upx2px(45) + (priceLength * 16) + (marketPrice.length * 11)), uni.upx2px(442))\r\n\t\t\t\t\r\n\t\t\t\t// // 库存\r\n\t\t\t\t// let surplus = '剩余：' + this.goodsInfo.stockQuantity + '份'\r\n\t\t\t\t// this.ctx.setFontSize(14);\r\n\t\t\t\t// this.ctx.setFillStyle('#FFFFFF');\r\n\t\t\t\t// this.ctx.fillText(surplus, (uni.upx2px(540) - uni.upx2px((surplus.length * 24) + 20)), (uni.upx2px(445)))\r\n\t\t\t\t\r\n\t\t\t\t// 库存\r\n\t\t\t\tlet surplus = '剩余：' + this.goodsInfo.stockQuantity + '份'\r\n\t\t\t\t// let surplus = '剩余：' + '100' + '份'\r\n\t\t\t\tthis.ctx.setFontSize(14);\r\n\t\t\t\tthis.ctx.setFillStyle('#FFFFFF');\r\n\t\t\t\tthis.ctx.fillText(surplus, (uni.upx2px(540) - uni.upx2px((surplus.length * 24) + 20)), (uni.upx2px(445)))\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t// 商品标题\r\n\t\t\t\tlet goodsName = this.goodsInfo.name\r\n\t\t\t\tif (goodsName.length >= 13) {\r\n\t\t\t\t\tgoodsName = goodsName.substring(0, 13) + '...'\r\n\t\t\t\t}\r\n\t\t\t\tthis.ctx.setFontSize(18);\r\n\t\t\t\tthis.ctx.setFillStyle('#333333');\r\n\t\t\t\tthis.ctx.fillText(goodsName, (uni.upx2px(20)), (uni.upx2px(525)))\r\n\t\t\t\t\r\n\t\t\t\t// 限购\r\n\t\t\t\tlet limit = '每人每日限购' + this.goodsInfo.limitCount + '个，每人总限购' + this.goodsInfo.sumLimitCount + '个'\r\n\t\t\t\tthis.ctx.setFontSize(12);\r\n\t\t\t\tthis.ctx.setFillStyle('#999999');\r\n\t\t\t\tthis.ctx.fillText(limit, (uni.upx2px(20)), (uni.upx2px(570)))\r\n\t\t\t\tthis.ctx.fillText( '活动结束时间：' + this.goodsInfo.endTime, (uni.upx2px(20)), (uni.upx2px(610)))\r\n\t\t\t\t\r\n\t\t\t\t//绘制虚线\r\n\t\t\t\tthis.drawDashLine(this.ctx, uni.upx2px(20), uni.upx2px(650), uni.upx2px(540), uni.upx2px(650), 5)\r\n\t\t\t\t\r\n\t\t\t\t// 左边实心圆\r\n\t\t\t\tthis.drawEmptyRound(this.ctx, 0, uni.upx2px(650), uni.upx2px(20))\r\n\t\t\t\t\r\n\t\t\t\t// 右边实心圆\r\n\t\t\t\tthis.drawEmptyRound(this.ctx, uni.upx2px(540), uni.upx2px(650), uni.upx2px(20))\r\n\t\t\t\t\r\n\t\t\t\t// 平台名称\r\n\t\t\t\tthis.ctx.setFontSize(20);\r\n\t\t\t\tthis.ctx.setFillStyle('#3C3C3C');\r\n\t\t\t\tthis.ctx.fillText(this.config.appletName, (uni.upx2px(20)), (uni.upx2px(730)))\r\n\t\t\t\t\r\n\t\t\t\t// 提示文案\r\n\t\t\t\tthis.ctx.setFontSize(13);\r\n\t\t\t\tthis.ctx.setFillStyle('#999999');\r\n\t\t\t\tthis.ctx.fillText('长按识别小程序二维码 →', (uni.upx2px(20)), (uni.upx2px(780)))\r\n\t\t\t\t\r\n\t\t\t\t// 小程序码\r\n\t\t\t\tlet qrcodeImg = await this.getImageInfo(this.qrcode)\r\n\t\t\t\tthis.ctx.drawImage(qrcodeImg.path, uni.upx2px(355), uni.upx2px(680), uni.upx2px(150), uni.upx2px(150))\r\n\t\t\t\t// // 延迟渲染\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.ctx.draw(true, () => {\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 500)\r\n\t\t\t},\r\n\t\t\t// 行文本换行\r\n\t\t\tdrawText(ctx, str, leftWidth, initHeight, titleHeight, canvasWidth) {\r\n\t\t\t\tlet lineWidth = 0;\r\n\t\t\t\tlet lastSubStrIndex = 0; //每次开始截取的字符串的索引\r\n\t\t\t\tfor (let i = 0; i < str.length; i++) {\r\n\t\t\t\t\tlineWidth += ctx.measureText(str[i]).width;\r\n\t\t\t\t\tif (lineWidth > canvasWidth) {\r\n\t\t\t\t\t\tctx.fillText(str.substring(lastSubStrIndex, i), leftWidth, initHeight); //绘制截取部分\r\n\t\t\t\t\t\tinitHeight += 22; //22为 文字大小20 + 2\r\n\t\t\t\t\t\tlineWidth = 0;\r\n\t\t\t\t\t\tlastSubStrIndex = i;\r\n\t\t\t\t\t\ttitleHeight += 22;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (i == str.length - 1) { //绘制剩余部分\r\n\t\t\t\t\t\tctx.fillText(str.substring(lastSubStrIndex, i + 1), leftWidth, initHeight);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// 标题border-bottom 线距顶部距离\r\n\t\t\t\ttitleHeight = titleHeight + 10;\r\n\t\t\t\treturn titleHeight;\r\n\t\t\t},\r\n\t\t\t// 绘制门店背景图\r\n\t\t\tstoreBgColor(ctx, x, y, color, radius) {\r\n\t\t\t\tctx.save();\r\n\t\t\t\tctx.setFillStyle(color);\r\n\t\t\t\tctx.fillRect(x, y, 255, 100);\r\n\t\t\t\tctx.closePath();\r\n\t\t\t},\r\n\t\t\t//绘制实心圆\r\n\t\t\tdrawEmptyRound(ctx, x, y, radius) {\r\n\t\t\t\tctx.save()\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.arc(x, y, radius, 0, 2 * Math.PI, true);\r\n\t\t\t\tctx.setFillStyle('rgba(0, 0, 0, .4)')\r\n\t\t\t\tctx.fill();\r\n\t\t\t\tctx.restore()\r\n\t\t\t\tctx.closePath()\r\n\t\t\t},\r\n\t\t\t//绘制虚线\r\n\t\t\tdrawDashLine(ctx, x1, y1, x2, y2, dashLength) {\r\n\t\t\t\tctx.setStrokeStyle(\"#cccccc\") //设置线条的颜色\r\n\t\t\t\tctx.setLineWidth(1) //设置线条宽度\r\n\t\t\t\tvar dashLen = dashLength,\r\n\t\t\t\t\txpos = x2 - x1, //得到横向的宽度;\r\n\t\t\t\t\typos = y2 - y1, //得到纵向的高度;\r\n\t\t\t\t\tnumDashes = Math.floor(Math.sqrt(xpos * xpos + ypos * ypos) / dashLen);\r\n\t\t\t\t//利用正切获取斜边的长度除以虚线长度，得到要分为多少段;\r\n\t\t\t\tfor (var i = 0; i < numDashes; i++) {\r\n\t\t\t\t\tif (i % 2 === 0) {\r\n\t\t\t\t\t\tctx.moveTo(x1 + (xpos / numDashes) * i, y1 + (ypos / numDashes) * i);\r\n\t\t\t\t\t\t//有了横向宽度和多少段，得出每一段是多长，起点 + 每段长度 * i = 要绘制的起点；\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tctx.lineTo(x1 + (xpos / numDashes) * i, y1 + (ypos / numDashes) * i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tctx.stroke();\r\n\t\t\t},\r\n\t\t\t// 绘制实线\r\n\t\t\tdrawSolidLine(ctx, x1, y1, x2, y2) {\r\n\t\t\t\tctx.setStrokeStyle(\"#cccccc\") //设置线条的颜色\r\n\t\t\t\tctx.setLineWidth(1) //设置线条宽度\r\n\t\t\t\tctx.moveTo(x1, y1)\r\n\t\t\t\tctx.lineTo(x2, y2)\r\n\t\t\t\tctx.stroke();\r\n\t\t\t},\r\n\t\t\t//带圆角图片\r\n\t\t\tdrawRoundImg(ctx, img, x, y, width, height, radius) {\r\n\t\t\t\tctx.beginPath()\r\n\t\t\t\tctx.save()\r\n\t\t\t\t// 左上角\r\n\t\t\t\t// ctx.arc(x + radius, y + radius, radius, Math.PI, Math.PI * 1.5)\r\n\t\t\t\t// 右上角\r\n\t\t\t\t// ctx.arc(x + width - radius, y + radius, radius, Math.PI * 1.5, Math.PI * 2)\r\n\t\t\t\t// 右下角\r\n\t\t\t\t// ctx.arc(x + width - radius, y + height - radius, radius, 0, Math.PI * 0.5)\r\n\t\t\t\t// 左下角\r\n\t\t\t\t// ctx.arc(x + radius, y + height - radius, radius, Math.PI * 0.5, Math.PI)\r\n\t\t\t\t// ctx.stroke()\r\n\t\t\t\t// ctx.clip()\r\n\t\t\t\tctx.drawImage(img, x, y, width, height);\r\n\t\t\t\tctx.restore()\r\n\t\t\t\tctx.closePath()\r\n\t\t\t},\r\n\t\t\t//圆角矩形\r\n\t\t\tdrawRoundRect(ctx, x, y, width, height, radius, color) {\r\n\t\t\t\tctx.save();\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.setFillStyle(color);\r\n\t\t\t\tctx.setStrokeStyle(color)\r\n\t\t\t\tctx.setLineJoin('round'); //交点设置成圆角\r\n\t\t\t\tctx.setLineWidth(radius);\r\n\t\t\t\tctx.strokeRect(x + radius / 2, y + radius / 2, width - radius, height - radius);\r\n\t\t\t\tctx.fillRect(x + radius, y + radius, width - radius * 2, height - radius * 2);\r\n\t\t\t\tctx.stroke();\r\n\t\t\t\tctx.closePath();\r\n\t\t\t},\r\n\t\t\t//获取图片\r\n\t\t\tgetImageInfo(imgSrc) {\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\tuni.getImageInfo({\r\n\t\t\t\t\t\tsrc: imgSrc,\r\n\t\t\t\t\t\tsuccess: (image) => {\r\n\t\t\t\t\t\t\tresolve(image);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\treject(err);\r\n\t\t\t\t\t\t\tconsole.log(err)\r\n\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t\tthis.isShow = false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t//保存图片到相册\r\n\t\t\tsaveImage() {\r\n\t\t\t\t//判断用户授权\r\n\t\t\t\tuni.getSetting({\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tif (Object.keys(res.authSetting).length > 0) {\r\n\t\t\t\t\t\t\t//判断是否有相册权限\r\n\t\t\t\t\t\t\tif (res.authSetting['scope.writePhotosAlbum'] == undefined) {\r\n\t\t\t\t\t\t\t\t//打开设置权限\r\n\t\t\t\t\t\t\t\tuni.openSetting({\r\n\t\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\t\tconsole.log('设置权限', res.authSetting)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (!res.authSetting['scope.writePhotosAlbum']) {\r\n\t\t\t\t\t\t\t\t\t//打开设置权限\r\n\t\t\t\t\t\t\t\t\tuni.openSetting({\r\n\t\t\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('设置权限', res.authSetting)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tvar that = this\r\n\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\tcanvasId: 'my-canvas',\r\n\t\t\t\t\tquality: 1,\r\n\t\t\t\t\tcomplete: (res) => {\r\n\t\t\t\t\t\tuni.saveImageToPhotosAlbum({\r\n\t\t\t\t\t\t\tfilePath: res.tempFilePath,\r\n\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '已保存到相册',\r\n\t\t\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\tthat.isShow = false\r\n\t\t\t\t\t\t\t\t}, 2000)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n\t.content {\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tbackground: rgba(0, 0, 0, .4);\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tz-index: 200;\r\n\r\n\t\t.save-btn {\r\n\t\t\tmargin-top: 35rpx;\r\n\t\t\tcolor: #FFFFFF;\r\n\t\t\tbackground: linear-gradient(to right, #FE726B, #FE956B);\r\n\t\t\tpadding: 15rpx 40rpx;\r\n\t\t\tborder-radius: 50rpx;\r\n\t\t}\r\n\t}\r\n</style>\r\n","import mod from \"-!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./qrcode-poster.vue?vue&type=style&index=0&id=05250973&scoped=true&lang=scss&\"; export default mod; export * from \"-!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\App\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./qrcode-poster.vue?vue&type=style&index=0&id=05250973&scoped=true&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1680766833550\n      var cssReload = require(\"F:/App/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}